# Maintainer: Felipe Alfonso Gonzalez <f.alfonso@res-ear.ch>
pkgname=reconn
pkgver=0.0.1
pkgrel=1
pkgdesc="AutoReconnect 'reconn' is a Python-based utility designed to manage WiFi connections using ConnMan on Linux systems."
arch=('x86_64')
url="https://github.com/felipealfonsog/AutoReconnect"
license=('BSD-3-Clause')
depends=('python' 'connman')

source=("https://github.com/felipealfonsog/AutoReconnect/archive/refs/tags/v.${pkgver}.tar.gz")

sha256sums=('41ae0b3468fc23dfcc1f451cbe8bf6f3f9d6023550b12ad6c3b244c20a098647')

prepare() {
  tar xf "v.${pkgver}.tar.gz" -C "$srcdir" --strip-components=1
}

package() {
  # Install the Python script
  install -Dm755 "$srcdir"/AutoReconnect-v."${pkgver}"/src/main.py "${pkgdir}/usr/local/bin/reconn.py"
  
  # Create a shell script to execute novanav.py and copy it to /usr/local/bin
  echo '#!/bin/bash' > reconn
  echo 'python3 /usr/local/bin/reconn.py "$@"' >> reconn
  chmod +x reconn
  install -Dm755 reconn "${pkgdir}/usr/local/bin/reconn"

  # Install the icon
  install -Dm644 -p "$srcdir"/AutoReconnect-v."${pkgver}"/src/reconn-iconlogo.png "${pkgdir}/usr/share/pixmaps/reconn.png"

  # Install the .desktop file
  install -Dm644 -p "$srcdir"/AutoReconnect-v."${pkgver}"/src/reconn.desktop "${pkgdir}/usr/share/applications/reconn.desktop"
}
